<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <title>Jison, parse table visualization page</title>

    <link rel="stylesheet" href="../../assets/styles/style.css" type="text/css" media="screen" charset="utf-8" />
    <link href="../../assets/styles/try.css" type="text/css" rel="stylesheet" media="screen" />
  </head>

  <body>
  <div id="container">
    <div id="header">
      <h1><a href="../../">Jison</a></h1>
    </div>
    <ul id="nav">
      <li><a href="../../docs/">docs</a></li>
      <li><a href="../../demos/">demos</a></li>
      <li><a href="../../try/">try</a></li>
      <li><a href="../../docs/#installation">install</a></li>
      <li><a href="../../community/">community</a></li>
    </ul>
    <div id="content">
      <h1>Calculator demo</h1>
      <p>This demo parses mathematical expressions and returns the answer, keeping the correct order of operations. </p>
      <p>Enter an expression to evaluate, such as PI*4^2 + 5:</p>
      <p>
        <input type="text" value="PI*4^2 + 5" /> <button>equals</button> <span></span>
      </p>

      <h2>The grammar</h2>
      <p>
      This Jison grammar was used to create the parser/evaluator:
      </p>

      <pre>

        /* description: Parses end evaluates mathematical expressions. */

        /* lexical grammar */
        %lex
        %%
        \s+                   {/* skip whitespace */}
        [0-9]+("."[0-9]+)?\b  {return 'NUMBER';}
        "*"                   {return '*';}
        "/"                   {return '/';}
        "-"                   {return '-';}
        "+"                   {return '+';}
        "^"                   {return '^';}
        "("                   {return '(';}
        ")"                   {return ')';}
        "PI"                  {return 'PI';}
        "E"                   {return 'E';}
        &lt;&lt;EOF>>               {return 'EOF';}

        /lex

        /* operator associations and precedence */

        %left '+' '-'
        %left '*' '/'
        %left '^'
        %left UMINUS

        %start expressions

        %% /* language grammar */

        expressions
            : e EOF
                {return $1;}
            ;

        e
            : e '+' e
                {$$ = $1 + $3;}
            | e '-' e
                {$$ = $1 - $3;}
            | e '*' e
                {$$ = $1 * $3;}
            | e '/' e
                {$$ = $1 / $3;}
            | e '^' e
                {$$ = Math.pow($1, $3);}
            | '-' e %prec UMINUS
                {$$ = -$2;}
            | '(' e ')'
                {$$ = $2;}
            | NUMBER
                {$$ = Number(yytext);}
            | E
                {$$ = Math.E;}
            | PI
                {$$ = Math.PI;}
            ;

    </pre>
  </div>

    <script src="../../assets/js/jquery.js"></script>
    <script src="../../assets/js/calculator.js"></script>
    <script>
      $(document).ready(function () {
        $("button").click(function () {
          try {
            var result = calculator.parse($("input").val());
            $("span").html(result);
          } catch (e) {
            $("span").html(String(e));
          }
        });
      });
    </script>
  </body>
</html>
